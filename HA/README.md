
# 高可用架构


## 1. 高可用架构

### 
    一个HA高可用+LB负载均衡+分布式架构：
![image](https://github.com/larkguo/Architecture/blob/master/HA/data/HA.png)

    上图说明：
		1.两种服务访问方式：
		 1)域名方式：一个集群所有主机对应一个域名，Client通过域名查找对应服务集群；
		 2)VIP方式：一个集群对外提供一个VIP地址，Client通过VIP地址直接访问整个集群；

		2.两种HA高可用方式：
		 1)集群节点通过Keepalived等软件实现HA高可用；
		 2)分布式集群自身的高可用，个别节点掉线不影响整个集群正常工作；

		3.两种负载均衡方式：
		 1)DNS负载均衡：通过DNS进行三层IP层的负载均衡；
		 2)负载均衡层：服务层之前增加方向代理进行四层和七层的负载均衡；

		4.服务层的区别：
		 1)服务集群节点完全对等：VIP地址可以映射到任意节点IP地址；
		 2)服务集群节点有主备区分，VIP地址应跟随主用节点IP地址，减少转发；
 
## 2. 高可用在存储领域的应用

###
    通用高可用架构经过变形组合，使用到存储服务上：
![image](https://github.com/larkguo/Architecture/blob/master/HA/data/store.png)

		上图说明：
		1.两种存储服务访问方式：
		 1)域名方式：一个集群所有主机对应一个域名，Client通过域名方式统一访问整个集群；
		 2)VIP方式：一个集群对外提供一个VIP地址，Client通过VIP地址访问整个集群；

		2.两种HA高可用方法：
		 1)集群节点通过Keepalived等软件实现HA高可用；
		 2)分布式集群自身的高可用，个别节点掉线不影响整个集群正常工作；

		3.一种负载均衡方式：
		 1)通过DNS进行负载均衡,对存储流量进行负载均衡。同时可对存储节点和业务的监控检查；

		4.存储集群的区别：
		 1)GlusterFS节点完全对等，VIP地址可以映射到任意节点IP地址；
		 2)Ceph有Leader主用节点，VIP地址应跟随主用节点IP地址，减少转发；
 
